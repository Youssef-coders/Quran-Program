<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>MRIS Quran Program</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    
    <!-- Load scripts in correct order -->
    <script src="script.js"></script>
    <!-- Remove conflicting auth.js -->
</head>
<body>
    <!-- Login Section -->
    <div id="loginSection" class="login-container">
        <div class="login-header">
            <button id="loginLanguageToggle" class="language-toggle-btn" title="Switch Language / تبديل اللغة">ع</button>
        </div>
        <div class="login-card">
                                            <h2 data-translate="login.title">MRIS Quran Program</h2>
                                <p style="font-size: 14px; color: #666; margin-bottom: 20px;" data-translate="login.subtitle">
                            Enter your unique code to access the MRIS Quran program
                        </p>
        <form id="loginForm">
                <div class="form-group">
                    <input type="text" id="userCode" data-translate-placeholder="login.placeholder" placeholder="Enter your unique code" required>
                </div>
                <button type="submit" id="loginBtn" class="login-btn" data-translate="login.button">Login</button>
            </form>
            
            <div style="margin-top: 20px; text-align: center;">
                <p style="color: #666; margin-bottom: 15px;" data-translate="login.no_account">Don't have an account?</p>
                <a href="signup.html" class="signup-link" data-translate="login.create_account">Create New Account</a>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading...</div>
        </div>
    </div>

    <!-- Dashboard Section -->
    <div id="dashboardSection" class="dashboard-container" style="display: none;">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="user-info">
                <span id="userName">Student Name</span>
                <span id="userClass">Class</span>
                <span id="userTeacher">Teacher</span>
            </div>
            <div class="header-actions">
                <button id="languageToggle" class="language-toggle-btn" title="Switch Language / تبديل اللغة">ع</button>
                <button id="testModalBtn" class="language-toggle-btn" onclick="testModal()" style="margin-right: 10px;" data-translate="options.title">Options</button>
                        <button id="logoutBtn" class="logout-btn" data-translate="header.logout" onclick="handleLogout()">Logout</button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Row: Two Cards Side by Side -->
            <div class="top-cards">
                <!-- Next Session's Hifz Card -->
                <div class="content-card hifz-card">
                    <h3 data-translate="content.next_content">Next Session's Content</h3>
                    <div class="content-items" id="hifzContent">
                        <!-- Content items will be added here -->
                    </div>
                    <button class="add-content-btn" id="addHifzBtn" style="display: none;">+</button>
                </div>

                <!-- Next Session's Revision Card -->
                <div class="content-card revision-card">
                    <h3 data-translate="content.next_recitation">Recitation and Reading</h3>
                    <div class="content-items" id="revisionContent">
                        <!-- Content items will be added here -->
                    </div>
                    <button class="add-content-btn" id="addRevisionBtn" style="display: none;">+</button>
                </div>
            </div>

            <!-- Bottom Row: Large Past Sessions Card -->
            <div class="past-sessions-card">
                <h3 data-translate="content.past_sessions">Past Sessions</h3>
                <div class="sessions-list" id="sessionsList">
                    <!-- Session items will be added here -->
                </div>
                <button class="add-content-btn" id="addSessionBtn" style="display: none;">+</button>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Add Hifz Modal -->
    <div id="addHifzModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h3 data-translate="modal.add_hifz">Add Hifz Content</h3>
            <form id="addHifzForm">
                <div class="form-group">
                    <label data-translate="modal.surah_name">Surah Name:</label>
                    <select id="hifzSurah" required>
                        <option value="" data-translate="modal.select_surah">Select Surah</option>
                        <option value="Al Fatiha">Al Fatiha</option>
                        <option value="Al Baqarah">Al Baqarah</option>
                        <option value="Al Imran">Al Imran</option>
                        <option value="An Nisa">An Nisa</option>
                        <option value="Al Ma'idah">Al Ma'idah</option>
                        <option value="Al An'am">Al An'am</option>
                        <option value="Al A'raf">Al A'raf</option>
                        <option value="Al Anfal">Al Anfal</option>
                        <option value="At Tawbah">At Tawbah</option>
                        <option value="Yunus">Yunus</option>
                        <option value="Hud">Hud</option>
                        <option value="Yusuf">Yusuf</option>
                        <option value="Ar Ra'd">Ar Ra'd</option>
                        <option value="Ibrahim">Ibrahim</option>
                        <option value="Al Hijr">Al Hijr</option>
                        <option value="An Nahl">An Nahl</option>
                        <option value="Al Isra">Al Isra</option>
                        <option value="Al Kahf">Al Kahf</option>
                        <option value="Maryam">Maryam</option>
                        <option value="Ta Ha">Ta Ha</option>
                        <option value="Al Anbiya">Al Anbiya</option>
                        <option value="Al Hajj">Al Hajj</option>
                        <option value="Al Mu'minun">Al Mu'minun</option>
                        <option value="An Nur">An Nur</option>
                        <option value="Al Furqan">Al Furqan</option>
                        <option value="Ash Shu'ara">Ash Shu'ara</option>
                        <option value="An Naml">An Naml</option>
                        <option value="Al Qasas">Al Qasas</option>
                        <option value="Al 'Ankabut">Al 'Ankabut</option>
                        <option value="Ar Rum">Ar Rum</option>
                        <option value="Luqman">Luqman</option>
                        <option value="As Sajdah">As Sajdah</option>
                        <option value="Al Ahzab">Al Ahzab</option>
                        <option value="Saba">Saba</option>
                        <option value="Fatir">Fatir</option>
                        <option value="Ya Sin">Ya Sin</option>
                        <option value="As Saffat">As Saffat</option>
                        <option value="Sad">Sad</option>
                        <option value="Az Zumar">Az Zumar</option>
                        <option value="Ghafir">Ghafir</option>
                        <option value="Fussilat">Fussilat</option>
                        <option value="Ash Shura">Ash Shura</option>
                        <option value="Az Zukhruf">Az Zukhruf</option>
                        <option value="Ad Dukhan">Ad Dukhan</option>
                        <option value="Al Jathiyah">Al Jathiyah</option>
                        <option value="Al Ahqaf">Al Ahqaf</option>
                        <option value="Muhammad">Muhammad</option>
                        <option value="Al Fath">Al Fath</option>
                        <option value="Al Hujurat">Al Hujurat</option>
                        <option value="Qaf">Qaf</option>
                        <option value="Adh Dhariyat">Adh Dhariyat</option>
                        <option value="At Tur">At Tur</option>
                        <option value="An Najm">An Najm</option>
                        <option value="Al Qamar">Al Qamar</option>
                        <option value="Ar Rahman">Ar Rahman</option>
                        <option value="Al Waqi'ah">Al Waqi'ah</option>
                        <option value="Al Hadid">Al Hadid</option>
                        <option value="Al Mujadilah">Al Mujadilah</option>
                        <option value="Al Hashr">Al Hashr</option>
                        <option value="Al Mumtahanah">Al Mumtahanah</option>
                        <option value="As Saff">As Saff</option>
                        <option value="Al Jumu'ah">Al Jumu'ah</option>
                        <option value="Al Munafiqun">Al Munafiqun</option>
                        <option value="At Taghabun">At Taghabun</option>
                        <option value="At Talaq">At Talaq</option>
                        <option value="At Tahrim">At Tahrim</option>
                        <option value="Al Mulk">Al Mulk</option>
                        <option value="Al Qalam">Al Qalam</option>
                        <option value="Al Haqqah">Al Haqqah</option>
                        <option value="Al Ma'arij">Al Ma'arij</option>
                        <option value="Nuh">Nuh</option>
                        <option value="Al Jinn">Al Jinn</option>
                        <option value="Al Muzzammil">Al Muzzammil</option>
                        <option value="Al Muddathir">Al Muddathir</option>
                        <option value="Al Qiyamah">Al Qiyamah</option>
                        <option value="Al Insan">Al Insan</option>
                        <option value="Al Mursalat">Al Mursalat</option>
                        <option value="An Naba">An Naba</option>
                        <option value="An Nazi'at">An Nazi'at</option>
                        <option value="Abasa">Abasa</option>
                        <option value="At Takwir">At Takwir</option>
                        <option value="Al Infitar">Al Infitar</option>
                        <option value="Al Mutaffifin">Al Mutaffifin</option>
                        <option value="Al Inshiqaq">Al Inshiqaq</option>
                        <option value="Al Buruj">Al Buruj</option>
                        <option value="At Tariq">At Tariq</option>
                        <option value="Al A'la">Al A'la</option>
                        <option value="Al Ghashiyah">Al Ghashiyah</option>
                        <option value="Al Fajr">Al Fajr</option>
                        <option value="Al Balad">Al Balad</option>
                        <option value="Ash Shams">Ash Shams</option>
                        <option value="Al Lail">Al Lail</option>
                        <option value="Ad Duha">Ad Duha</option>
                        <option value="Ash Sharh">Ash Sharh</option>
                        <option value="At Tin">At Tin</option>
                        <option value="Al 'Alaq">Al 'Alaq</option>
                        <option value="Al Qadr">Al Qadr</option>
                        <option value="Al Bayyinah">Al Bayyinah</option>
                        <option value="Az Zalzalah">Az Zalzalah</option>
                        <option value="Al 'Adiyat">Al 'Adiyat</option>
                        <option value="Al Qari'ah">Al Qari'ah</option>
                        <option value="At Takathur">At Takathur</option>
                        <option value="Al 'Asr">Al 'Asr</option>
                        <option value="Al Humazah">Al Humazah</option>
                        <option value="Al Fil">Al Fil</option>
                        <option value="Quraish">Quraish</option>
                        <option value="Al Ma'un">Al Ma'un</option>
                        <option value="Al Kawthar">Al Kawthar</option>
                        <option value="Al Kafirun">Al Kafirun</option>
                        <option value="An Nasr">An Nasr</option>
                        <option value="Al Masad">Al Masad</option>
                        <option value="Al Ikhlas">Al Ikhlas</option>
                        <option value="Al Falaq">Al Falaq</option>
                        <option value="An Nas">An Nas</option>
                    </select>
                </div>
                <div class="form-group">
                    <label data-translate="modal.ayah_range">Ayah Range:</label>
                    <div id="hifzAyahRangeContainer">
                        <!-- Ayah range dropdowns will be generated here -->
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">Add</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addHifzModal')" data-translate="modal.cancel">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Revision Modal -->
    <div id="addRevisionModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h3 data-translate="modal.add_revision">Add Revision Content</h3>
            <form id="addRevisionForm">
                <div class="form-group">
                    <label data-translate="modal.surah_name">Surah Name:</label>
                    <select id="revisionSurah" required>
                        <option value="" data-translate="modal.select_surah">Select Surah</option>
                        <option value="Al Fatiha">Al Fatiha</option>
                        <option value="Al Baqarah">Al Baqarah</option>
                        <option value="Al Imran">Al Imran</option>
                        <option value="An Nisa">An Nisa</option>
                        <option value="Al Ma'idah">Al Ma'idah</option>
                        <option value="Al An'am">Al An'am</option>
                        <option value="Al A'raf">Al A'raf</option>
                        <option value="Al Anfal">Al Anfal</option>
                        <option value="At Tawbah">At Tawbah</option>
                        <option value="Yunus">Yunus</option>
                        <option value="Hud">Hud</option>
                        <option value="Yusuf">Yusuf</option>
                        <option value="Ar Ra'd">Ar Ra'd</option>
                        <option value="Ibrahim">Ibrahim</option>
                        <option value="Al Hijr">Al Hijr</option>
                        <option value="An Nahl">An Nahl</option>
                        <option value="Al Isra">Al Isra</option>
                        <option value="Al Kahf">Al Kahf</option>
                        <option value="Maryam">Maryam</option>
                        <option value="Ta Ha">Ta Ha</option>
                        <option value="Al Anbiya">Al Anbiya</option>
                        <option value="Al Hajj">Al Hajj</option>
                        <option value="Al Mu'minun">Al Mu'minun</option>
                        <option value="An Nur">An Nur</option>
                        <option value="Al Furqan">Al Furqan</option>
                        <option value="Ash Shu'ara">Ash Shu'ara</option>
                        <option value="An Naml">An Naml</option>
                        <option value="Al Qasas">Al Qasas</option>
                        <option value="Al 'Ankabut">Al 'Ankabut</option>
                        <option value="Ar Rum">Ar Rum</option>
                        <option value="Luqman">Luqman</option>
                        <option value="As Sajdah">As Sajdah</option>
                        <option value="Al Ahzab">Al Ahzab</option>
                        <option value="Saba">Saba</option>
                        <option value="Fatir">Fatir</option>
                        <option value="Ya Sin">Ya Sin</option>
                        <option value="As Saffat">As Saffat</option>
                        <option value="Sad">Sad</option>
                        <option value="Az Zumar">Az Zumar</option>
                        <option value="Ghafir">Ghafir</option>
                        <option value="Fussilat">Fussilat</option>
                        <option value="Ash Shura">Ash Shura</option>
                        <option value="Az Zukhruf">Az Zukhruf</option>
                        <option value="Ad Dukhan">Ad Dukhan</option>
                        <option value="Al Jathiyah">Al Jathiyah</option>
                        <option value="Al Ahqaf">Al Ahqaf</option>
                        <option value="Muhammad">Muhammad</option>
                        <option value="Al Fath">Al Fath</option>
                        <option value="Al Hujurat">Al Hujurat</option>
                        <option value="Qaf">Qaf</option>
                        <option value="Adh Dhariyat">Adh Dhariyat</option>
                        <option value="At Tur">At Tur</option>
                        <option value="An Najm">An Najm</option>
                        <option value="Al Qamar">Al Qamar</option>
                        <option value="Ar Rahman">Ar Rahman</option>
                        <option value="Al Waqi'ah">Al Waqi'ah</option>
                        <option value="Al Hadid">Al Hadid</option>
                        <option value="Al Mujadilah">Al Mujadilah</option>
                        <option value="Al Hashr">Al Hashr</option>
                        <option value="Al Mumtahanah">Al Mumtahanah</option>
                        <option value="As Saff">As Saff</option>
                        <option value="Al Jumu'ah">Al Jumu'ah</option>
                        <option value="Al Munafiqun">Al Munafiqun</option>
                        <option value="At Taghabun">At Taghabun</option>
                        <option value="At Talaq">At Talaq</option>
                        <option value="At Tahrim">At Tahrim</option>
                        <option value="Al Mulk">Al Mulk</option>
                        <option value="Al Qalam">Al Qalam</option>
                        <option value="Al Haqqah">Al Haqqah</option>
                        <option value="Al Ma'arij">Al Ma'arij</option>
                        <option value="Nuh">Nuh</option>
                        <option value="Al Jinn">Al Jinn</option>
                        <option value="Al Muzzammil">Al Muzzammil</option>
                        <option value="Al Muddathir">Al Muddathir</option>
                        <option value="Al Qiyamah">Al Qiyamah</option>
                        <option value="Al Insan">Al Insan</option>
                        <option value="Al Mursalat">Al Mursalat</option>
                        <option value="An Naba">An Naba</option>
                        <option value="An Nazi'at">An Nazi'at</option>
                        <option value="Abasa">Abasa</option>
                        <option value="At Takwir">At Takwir</option>
                        <option value="Al Infitar">Al Infitar</option>
                        <option value="Al Mutaffifin">Al Mutaffifin</option>
                        <option value="Al Inshiqaq">Al Inshiqaq</option>
                        <option value="Al Buruj">Al Buruj</option>
                        <option value="At Tariq">At Tariq</option>
                        <option value="Al A'la">Al A'la</option>
                        <option value="Al Ghashiyah">Al Ghashiyah</option>
                        <option value="Al Fajr">Al Fajr</option>
                        <option value="Al Balad">Al Balad</option>
                        <option value="Ash Shams">Ash Shams</option>
                        <option value="Al Lail">Al Lail</option>
                        <option value="Ad Duha">Ad Duha</option>
                        <option value="Ash Sharh">Ash Sharh</option>
                        <option value="At Tin">At Tin</option>
                        <option value="Al 'Alaq">Al 'Alaq</option>
                        <option value="Al Qadr">Al Qadr</option>
                        <option value="Al Bayyinah">Al Bayyinah</option>
                        <option value="Az Zalzalah">Az Zalzalah</option>
                        <option value="Al 'Adiyat">Al 'Adiyat</option>
                        <option value="Al Qari'ah">Al Qari'ah</option>
                        <option value="At Takathur">At Takathur</option>
                        <option value="Al 'Asr">Al 'Asr</option>
                        <option value="Al Humazah">Al Humazah</option>
                        <option value="Al Fil">Al Fil</option>
                        <option value="Quraish">Quraish</option>
                        <option value="Al Ma'un">Al Ma'un</option>
                        <option value="Al Kawthar">Al Kawthar</option>
                        <option value="Al Kafirun">Al Kafirun</option>
                        <option value="An Nasr">An Nasr</option>
                        <option value="Al Masad">Al Masad</option>
                        <option value="Al Ikhlas">Al Ikhlas</option>
                        <option value="Al Falaq">Al Falaq</option>
                        <option value="An Nas">An Nas</option>
                    </select>
                </div>
                <div class="form-group">
                    <label data-translate="modal.ayah_range">Ayah Range:</label>
                    <div id="revisionAyahRangeContainer">
                        <!-- Ayah range dropdowns will be generated here -->
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">Add</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addRevisionModal')" data-translate="modal.cancel">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Session Modal -->
    <div id="addSessionModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h3 data-translate="modal.add_session">Add Session</h3>
            <form id="addSessionForm">
                <div class="form-group">
                    <label data-translate="modal.date">Date:</label>
                    <input type="date" id="sessionDate" required>
                </div>
                <div class="form-group">
                    <label data-translate="session.hifz_surahs">Hifz Surah(s) & Ayah Numbers:</label>
                    <div id="hifzItemsContainer">
                        <div class="session-item-row">
                            <select class="session-hifz-surah" onchange="toggleHifzAddButton(this)">
                                <option value="">Select Hifz Item</option>
                            </select>
                            <button type="button" class="btn btn-small btn-secondary" onclick="addHifzItem()" style="display: none;">+</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label data-translate="session.revision_surahs">Revision Surah(s) & Ayah Numbers:</label>
                    <div id="revisionItemsContainer">
                        <div class="session-item-row">
                            <select class="session-revision-surah" onchange="toggleRevisionAddButton(this)">
                                <option value="">Select Revision Item</option>
                            </select>
                            <button type="button" class="btn btn-small btn-secondary" onclick="addRevisionItem()" style="display: none;">+</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label data-translate="modal.score">Score:</label>
                    <select id="sessionScore" required>
                        <option value="" data-translate="modal.select_score">Select Score</option>
                        <option value="10">10</option>
                        <option value="9">9</option>
                        <option value="8">8</option>
                        <option value="7">7</option>
                        <option value="6">6</option>
                        <option value="5">5</option>
                        <option value="4">4</option>
                        <option value="3">3</option>
                        <option value="2">2</option>
                        <option value="1">1</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary" data-translate="modal.add">Add</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addSessionModal')" data-translate="modal.cancel">Cancel</button>
                </div>
            </form>
        </div>
    </div>


    <!-- Create Account Modal (for admin) -->
    <div id="createAccountModal" class="modal">
        <div class="modal-content" style="max-width: 600px; max-height: 90vh; overflow-y: auto;">
            <span class="modal-close" onclick="closeModal('createAccountModal')">&times;</span>
            <h3 data-translate="account.create_title">Create New Account</h3>
            <form id="createAccountForm" onsubmit="handleCreateAccount(event)">
                <div class="form-group">
                    <label for="accountType" data-translate="account.account_type">Account Type</label>
                    <select id="accountType" required onchange="handleAccountTypeChange()">
                        <option value="" data-translate="account.select_type">Select Account Type</option>
                        <option value="student" data-translate="account.student">Student</option>
                        <option value="teacher" data-translate="account.teacher">Teacher</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="firstName" data-translate="account.first_name">First Name</label>
                    <input type="text" id="firstName" required>
                </div>
                <div class="form-group">
                    <label for="lastName" data-translate="account.last_name">Last Name</label>
                    <input type="text" id="lastName" required>
                </div>
                <div class="form-group">
                    <label for="email" data-translate="account.email">Email Address (Optional)</label>
                    <input type="email" id="email">
                </div>
                <div class="form-group">
                    <label for="phone" data-translate="account.phone">Phone Number (Optional)</label>
                    <input type="tel" id="phone" placeholder="+966XXXXXXXXX">
                </div>
                <div class="form-group">
                    <label for="grade" data-translate="account.grade">Grade</label>
                    <select id="grade" required onchange="updateClassOptions()">
                        <option value="" data-translate="account.select_grade">Select Grade</option>
                        <option value="5" data-translate="account.grade_5">Grade 5</option>
                        <option value="6" data-translate="account.grade_6">Grade 6</option>
                        <option value="7" data-translate="account.grade_7">Grade 7</option>
                        <option value="8" data-translate="account.grade_8">Grade 8</option>
                        <option value="9" data-translate="account.grade_9">Grade 9</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="className" data-translate="account.class">Class</label>
                    <select id="className" required>
                        <option value="" data-translate="account.select_grade_first">Select Grade First</option>
                    </select>
                </div>
                <div class="form-group" id="teacherNameGroup" style="display: none;">
                    <label for="teacherName" data-translate="account.teacher_name">Teacher Name (Optional)</label>
                    <select id="teacherName">
                        <option value="" data-translate="account.leave_unassigned">Leave unassigned</option>
                    </select>
                </div>
                <div class="form-group" id="teacherGradesGroup" style="display: none;">
                    <label data-translate="account.teacher_grades">What grades do you teach?</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" name="teacherGrades" value="5">
                            <span>Grade 5</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="teacherGrades" value="6">
                            <span>Grade 6</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="teacherGrades" value="7">
                            <span>Grade 7</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="teacherGrades" value="8">
                            <span>Grade 8</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="teacherGrades" value="9">
                            <span>Grade 9</span>
                        </label>
                    </div>
                </div>
                <div class="form-group" id="teacherClassesGroup" style="display: none;">
                    <label data-translate="account.teacher_classes">What classes do you teach?</label>
                    <div class="checkbox-group" id="teacherClassesCheckboxes">
                        <p data-translate="account.select_grades_first">Select grades first</p>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('createAccountModal')" data-translate="modal.cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary" data-translate="account.create_title">Create Account</button>
                </div>
            </form>
        </div>
    </div>

                    <!-- Assign Students Modal (for admin) -->
                <div id="assignStudentsModal" class="modal">
                    <div class="modal-content">
                        <span class="modal-close" onclick="closeModal('assignStudentsModal')">&times;</span>
                        <h3 data-translate="admin.assign_students">Assign Students to Teachers</h3>
                        <p style="text-align: center; color: #666; margin-bottom: 25px;" data-translate="admin.assign_description">
                            Select a teacher and then choose an unassigned student to create an assignment.
                        </p>
                        <div class="assignment-section">
                            <div class="form-group">
                                <label for="assignTeacher">Select Teacher:</label>
                                <select id="assignTeacher" onchange="loadUnassignedStudents()">
                                    <option value="">Choose a teacher...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="assignStudent">Select Student:</label>
                                <select id="assignStudent">
                                    <option value="">Choose a teacher first...</option>
                                </select>
                            </div>
                            <div class="modal-actions">
                                <button type="button" class="btn btn-primary" onclick="assignStudentToTeacher()" data-translate="admin.assign_student">Assign Student</button>
                                <button type="button" class="btn btn-secondary" onclick="closeModal('assignStudentsModal')" data-translate="modal.cancel">Cancel</button>
                            </div>
                        </div>
                        <div class="current-assignments">
                            <h4>Current Assignments</h4>
                            <div id="currentAssignmentsList">
                                <!-- Current assignments will be displayed here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Delete Student Modal -->
                <div id="deleteStudentModal" class="modal">
                    <div class="modal-content">
                        <span class="modal-close" onclick="closeModal('deleteStudentModal')">&times;</span>
                        <h3 data-translate="admin.delete_student">Delete Student</h3>
                        <div class="delete-student-content">
                            <p style="text-align: center; color: #666; margin-bottom: 20px;" data-translate="admin.delete_student_warning">
                                Select a student to delete from the system.
                            </p>
                            <div class="form-group">
                                <label for="deleteStudentSelect">Select Student:</label>
                                <select id="deleteStudentSelect">
                                    <option value="">Choose a student...</option>
                                </select>
                            </div>
                            <div class="student-preview" id="studentPreview" style="display: none;">
                                <h4 data-translate="admin.student_info">Student Information</h4>
                                <div class="student-details">
                                    <p><strong data-translate="admin.name">Name:</strong> <span id="previewStudentName"></span></p>
                                    <p><strong data-translate="admin.class">Class:</strong> <span id="previewStudentClass"></span></p>
                                    <p><strong data-translate="admin.teacher">Teacher:</strong> <span id="previewStudentTeacher"></span></p>
                                    <p><strong data-translate="admin.content_items">Content Items:</strong> <span id="previewStudentContent"></span></p>
                                </div>
                            </div>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn-danger" onclick="confirmDeleteStudent()" id="confirmDeleteBtn" disabled data-translate="delete.confirm_delete_student">Delete Student</button>
                            <button type="button" class="btn btn-secondary" onclick="closeModal('deleteStudentModal')" data-translate="modal.cancel">Cancel</button>
                        </div>
                    </div>
                </div>

                <!-- Delete Teacher Modal -->
                <div id="deleteTeacherModal" class="modal">
                    <div class="modal-content">
                        <span class="modal-close" onclick="closeModal('deleteTeacherModal')">&times;</span>
                        <h3 data-translate="admin.delete_teacher">Delete Teacher</h3>
                        <div class="delete-teacher-content">
                            <p style="text-align: center; color: #666; margin-bottom: 20px;" data-translate="admin.delete_teacher_warning">
                                Select a teacher to delete from the system.
                            </p>
                            <div class="form-group">
                                <label for="deleteTeacherSelect">Select Teacher:</label>
                                <select id="deleteTeacherSelect">
                                    <option value="">Choose a teacher...</option>
                                </select>
                            </div>
                            <div class="teacher-preview" id="teacherPreview" style="display: none;">
                                <h4 data-translate="admin.teacher_info">Teacher Information</h4>
                                <div class="teacher-details">
                                    <p><strong data-translate="admin.name">Name:</strong> <span id="previewTeacherName"></span></p>
                                    <p><strong data-translate="admin.assigned_students">Assigned Students:</strong> <span id="previewTeacherStudents"></span></p>
                                    <p><strong data-translate="admin.impact">Impact:</strong> <span id="previewTeacherImpact"></span></p>
                                </div>
                            </div>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn-danger" onclick="confirmDeleteTeacher()" id="confirmDeleteTeacherBtn" disabled data-translate="delete.confirm_delete_teacher">Delete Teacher</button>
                            <button type="button" class="btn btn-secondary" onclick="closeModal('deleteTeacherModal')" data-translate="modal.cancel">Cancel</button>
                        </div>
                    </div>
                </div>

                <!-- Logout confirmation modal removed - direct logout now! -->

                <!-- Class Selection Modal for Teachers -->
                <div id="classSelectionModal" class="modal">
                    <div class="modal-content">
                        <span class="modal-close" onclick="closeModal('classSelectionModal')">&times;</span>
                        <h3 data-translate="teacher.select_class">Select a Class</h3>
                        <p data-translate="teacher.class_description">Choose a class to view and assign students</p>
                        <div id="classesList" class="classes-grid">
                            <!-- Classes will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Student Selection Modal -->
                <div id="studentSelectionModal" class="modal">
                    <div class="modal-content">
                        <span class="modal-close" onclick="closeModal('studentSelectionModal')">&times;</span>
                        <h3 data-translate="teacher.select_student">Select Students</h3>
                        <p id="selectedClassInfo" data-translate="teacher.students_in_class">Students in this class:</p>
                        <div class="modal-actions" style="margin-bottom: 20px;">
                            <button type="button" class="btn btn-primary" onclick="addSelectedStudents()" data-translate="teacher.add_selected">Add Selected Students</button>
                            <button type="button" class="btn btn-secondary" onclick="closeModal('studentSelectionModal')" data-translate="modal.cancel">Cancel</button>
                        </div>
                        <div id="studentsList" class="students-grid">
                            <!-- Students will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Teacher Dashboard Options Modal -->
                <div id="teacherOptionsModal" class="modal">
                    <div class="modal-content">
                        <span class="modal-close" onclick="closeModal('teacherOptionsModal')">&times;</span>
                        <h3 data-translate="teacher.dashboard_options">Teacher Dashboard Options</h3>
                        <p data-translate="teacher.choose_action">Choose an action:</p>
                        <div class="teacher-options">
                            <button type="button" class="btn btn-primary" onclick="showClassSelection()" data-translate="teacher.add_student">Add Student</button>
                            <button type="button" class="btn btn-primary" onclick="showAssignedStudents()" data-translate="teacher.edit_students">Edit Students</button>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn-secondary" onclick="closeModal('teacherOptionsModal')" data-translate="modal.cancel">Cancel</button>
                        </div>
                    </div>
                </div>

    <!-- Firebase Configuration -->
    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBSOZYCUMqO9KEr9a93GaanxuIelJIIIGM",
            authDomain: "quran-tracker-6a536.firebaseapp.com",
            projectId: "quran-tracker-6a536",
            storageBucket: "quran-tracker-6a536.firebasestorage.app",
            messagingSenderId: "988749694504",
            appId: "1:988749694504:web:91af1972179d797409171d"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
    </script>
    
    <!-- Load Firebase Service -->
    <script src="firebaseService.js"></script>
</body>
</html>
